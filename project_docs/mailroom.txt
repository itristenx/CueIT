# 📦 Nova Mailroom Module  
_A submodule of `Pulse:Ops` with Orbit and Workflow integrations_

## 🔧 Module Info
- **Name:** Nova Mailroom
- **Parent Module:** Pulse > Ops
- **Integrations:** Orbit, Inventory, Workflows, Helix, Notifications, Audit, Cosmo
- **Primary Users:** Ops Technicians, Ops Leads, Admins, End Users (via Orbit)

---

## 🎯 Purpose

Nova Mailroom manages the full lifecycle of all deliveries entering and leaving a company location:
- Physical package and document intake
- Smart routing to recipients or internal departments
- Secure pickup and auditing
- SLA and notification management
- Optional locker/kiosk workflows

---

## 🧩 Core Features

### 📬 Inbound Delivery
- `Scan Label (OCR + Barcode)`
- `Auto-match Recipient (Nova ID)`
- `Assign Delivery Zone or Locker`
- `Link to Existing Tickets or Assets`
- `Notify Recipient (Slack/Email)`
- `Track Status (Inbound > Ready > Picked Up)`

### 📤 Outbound Delivery
- `Create Shipment`
- `Auto-fill Label (UPS/FedEx Integration)`
- `Schedule Pickup`
- `Track Outbound Status`
- `Link to Tickets or Requests`

### 🏷 Label & Tagging
- Support: QR / Barcode / NFC
- AI-parsed fields via Cosmo:
  - Sender / Recipient
  - Department
  - Package Type
  - Flags (e.g., Sensitive, Hardware)
  - Related Ticket ID

### 🧑‍💼 Recipient Matching
- Cross-check with:
  - Nova ID
  - SCIM Directory
- Support proxy pickup
- Confirmation photo / PIN / kiosk login

### 📦 Bulk Package Intake
- Multi-item scanning and batching
- Spreadsheet imports
- Bulk assign and notify

### 🔐 Secure Pickup + Lockers
- Smart locker API integration
- Scheduled pickup support
- Expiration and alert system
- Signature/photo verification on pickup

### 📲 Notification Engine
- Channels:
  - Slack
  - Email
  - SMS (optional)
- Alerts:
  - Package arrived
  - Ready for pickup
  - Auto-reminders
  - Expired or escalated

---

## 🔁 Workflow Integration

### Triggers
- `Package linked to asset` → Notifies IT
- `Sensitive docs received` → Notifies HR / ISAC
- `HR welcome package delivered` → Workflow trigger

### Request Catalog Support
- Request outbound shipment
- Request secure delivery
- Log missed delivery

### Cosmo-Driven Logic
- NLP parsing on label or user request
- “Where is my package?” conversational queries
- Smart suggestions for routing or assignment

---

## 🔐 RBAC Matrix

| Role             | Access Level                                                  |
|------------------|---------------------------------------------------------------|
| `ops_technician` | Full create/update/view of packages, assign, log handoffs     |
| `ops_lead`       | Override permissions, edit SLA, view all records              |
| `admin`          | Configure module settings, API keys, locker integrations      |
| `end_user`       | View personal deliveries, schedule pickups, delegate proxy    |
| `hr`, `it`, etc. | Can view delivery metadata only if linked to related ticket   |

---

## 🗃 Data Schema

### `packages`
- `id`
- `tracking_number`
- `carrier`
- `sender`
- `recipient_id` (linked to Nova ID)
- `department`
- `package_type`
- `status` (`inbound`, `ready`, `picked_up`, `returned`)
- `assigned_location`
- `linked_ticket_id`
- `linked_asset_id`
- `flags[]`
- `timestamps`

### `delivery_events`
- `event_type` (e.g., scanned, moved, picked_up)
- `performed_by`
- `location`
- `timestamp`
- `photo_url`
- `signature_blob`

### `proxy_authorizations`
- `recipient_id`
- `proxy_id`
- `package_id`
- `expiration`
- `status`

---

## 🌐 API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/mailroom/packages` | `POST` | Create a new package record |
| `/mailroom/packages/:id` | `GET` | Retrieve package details |
| `/mailroom/packages/:id/status` | `PATCH` | Update package status |
| `/mailroom/packages/:id/assign-proxy` | `POST` | Assign proxy for pickup |
| `/mailroom/packages/:id/link-ticket` | `POST` | Link to ticket |
| `/mailroom/workflows/trigger` | `POST` | Trigger custom workflow |
| `/mailroom/packages/bulk` | `POST` | Bulk import packages |

---

## 📲 Kiosk & Mobile

### iPad Kiosk App
- Pickup flow with:
  - PIN
  - Face/photo verification
- Scan-to-log
- Offline cache + sync

### iOS Admin View
- Scanner with OCR + barcode
- Assignment and tagging UI
- Quick pickup confirmation flow

---

## ⚙️ Config Flags (Core Admin Panel)

| Flag | Description |
|------|-------------|
| `enable_locker_support` | Enable locker integration (external API) |
| `enable_photo_verification` | Require photo at pickup |
| `max_package_retention_days` | Auto-escalate/expire after X days |
| `enable_sms_alerts` | Send SMS alerts in addition to Slack/Email |
| `allowed_carriers[]` | Restrict package carriers shown to agents |
| `proxy_pickup_enabled` | Allow proxy pickups for users |

---

## 🔐 Auditing & Compliance

- All handoffs, changes, pickups, and escalations are logged
- Includes:
  - IP address
  - Device ID (if via kiosk)
  - Timestamp
  - Photo/signature
- Full export API for audits
- SLA breach alerts
- Retention policy support

---

## 🧠 Cosmo AI Support

- Suggest recipient and priority from scanned labels
- Answer questions like:
  - “Has my laptop arrived?”
  - “Who picked up my package?”
- Proactive notification summaries
- Assistant view in Orbit + Pulse

---

## 🧩 Integrations

| System        | Purpose                                      |
|---------------|----------------------------------------------|
| Nova Orbit    | End user delivery notifications              |
| Nova Inventory| Tag assets received via package              |
| Nova Workflow | Trigger actions upon delivery events         |
| Helix         | Recipient lookup, SSO-proxy auth             |
| Notifications | Delivery status alerts                       |
| Slack App     | Alerts, pickup reminders, Cosmo queries      |
| Kiosk (Beacon)| Secure pickup and drop-off interface         |
| Lockers (API) | Smart locker hardware integration            |

---

## 🧪 Sample Use Cases

1. **IT Asset Arrival**
   - Package scanned → matched to John Doe
   - Linked to REQ12345 (new hire)
   - Notification sent to IT tech
   - Pickup confirmed and linked to Inventory asset

2. **Secure HR Document**
   - Delivered envelope flagged "Sensitive"
   - Routed to HR
   - Only HR Lead can view package metadata
   - Pickup requires kiosk face scan + signature

3. **Bulk Equipment Shipment**
   - Ops receives 20 laptops
   - Bulk scan assigns all to IT queue
   - Each scanned and tracked individually
   - Linked to batch REQ ticket

---

## 🧭 Future Enhancements

- Auto disposal flows
- Smart sensors for locker units
- Integration with ID badge readers
- Visitor/package merge (interview kits)
- Pre-scheduled pickup with calendar integration

---

## 📂 File Naming + Ticket Linking

| Prefix | Use |
|--------|-----|
| `PKG123456` | Unique package ID |
| `PKG-REQ123456` | Package linked to ticket |
| `PKG-INV987654` | Package linked to asset |

---
